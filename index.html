<!doctype html>
<html>
	<head>
		<title><3</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				background-color: #000000;
				margin: 0px;
				overflow: hidden;
			}

			.parent {
				position: absolute;
				z-index: 100;
				display: flex;
				justify-content: center;
				align-items: center;
				width: 100%;
				height:100%;
				left:0px;
				top:0px;
			}

			.te,.amo {
				font-family:helvetica;
				font-size: 56px;
				position: relative;
				color: #fe4334;
				text-align:center;
				width:50%;
			}
		</style>
		<script src="he3/three.js/three.min.js"></script>
		<script src="he3/colours.js"></script>
		<script src="models/ColladaLoader.js"></script>
	</head>
	<body>
		<script>
			var camera, scene, renderer;

			var heart;

			var bgPeriod = 15;
			var heartPeriod = 30;


			init();
			animate();

			function init() {
				var container = 
				scene = new THREE.Scene();
				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 10000 );
				camera.position.z = 400;

				renderer = new THREE.WebGLRenderer();
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );

				var loadingManager = new THREE.LoadingManager( function() {
					console.log("added heart");
					scene.add( heart );
				} );

				var loader = new THREE.ColladaLoader( loadingManager );
				loader.load( './models/Heart.dae', function ( collada ) {
					heart = collada.scene;
					heart.scale.set(2,2,2);
					heart.children[0].position.set(0,-200,0);
					heart.children[0].rotation.set(0,0,0);
					var material = new THREE.MeshToonMaterial();
					heart.children[0].material = material;
				} );

				var directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );
				directionalLight.position.set(400,400,400);
				scene.add(directionalLight);

				var directionalLight2 = new THREE.DirectionalLight( 0xffffff, 0.5 );
				directionalLight2.position.set(-400,-400,-400);
				scene.add(directionalLight2);

				window.addEventListener( 'resize', onWindowResize, false );
			}

			function animate() {
				requestAnimationFrame(animate);
				render();
			}

			function render() {
				var time = Date.now()/1000;
				var hue = ( time % bgPeriod ) / bgPeriod;
				var bgColour = he3.colours.getSoft( hue );
				scene.background = bgColour;

				if(typeof heart !== 'undefined') {
					heart.rotation.x = 2 * Math.PI * (time % heartPeriod ) / heartPeriod;
					heart.rotation.y = 2 * Math.PI * (time % (2 * heartPeriod) ) / (2 * heartPeriod);

					var heartColour = he3.colours.getHard( (hue + 0.5) % 1 );
					heart.children[0].material.color = heartColour;	
				}
		
				renderer.render( scene, camera );
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

		</script>
		<div class="parent">
			<div class="te">te</div>
			<div class="amo">amo</div>
		</div>
	</body>
</html>
